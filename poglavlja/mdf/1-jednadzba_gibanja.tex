\section{Jednadžba gibanja slobodnih oscilacija}\label{slobodne_oscilacije}
Jedan od modela sustava s više stupnjeva slobode su $N$ etažni posmični
okviri. Takvi sustavi se sastoje od $N$ koncentriranih masa, što znači da je potrebno 
odrediti $N$ različitih pomaka. Drugim riječima, jednadžba gibanja takvog sustava biti će
zadana kao sustav od N diferencijalnih jednadžbi drugog reda.
\par

Sustav s više stupnjeva slobode, koji će biti razmatran u ovom radu, je dvoetažni
posmični okvir bez prigušenja prikazan na sljedećoj slici, a osnovni pojmovi biti će 
objašnjeni pomoću slobodnih oscilacija navedenog modela.
\begin{figure}[H]
    \begin{subfigure}[b]{0.5\textwidth}
        \centering
        \input{skice/mdf/nepriguseni-sustav-mdf}
        \caption{}
        \label{fig:nepriguseni_sustav_okvir-2dof}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.5\textwidth}
        \centering
        \input{skice/mdf/nepriguseni-ekvivalentni-sustav-mdf}
        \caption{}
        \label{fig:nepriguseni_ekvivalentni_sustav-2dof}
    \end{subfigure}
    \vfill
    \vspace{0.5cm}
    \begin{subfigure}[b]{1\textwidth}
        \centering
        \input{skice/mdf/sile-nepriguseni-ekvivalentni-sustav-mdf.tex}
        \caption{}
        \label{fig:sile_nepriguseni_ekvivalentni_sustav-2dof}
    \end{subfigure}
    \caption{Idealizirani sustav s dva stupnja slobode: 
        (\subref{fig:nepriguseni_sustav_okvir-2dof}) dvoetažni posmični okvir;
        (\subref{fig:nepriguseni_ekvivalentni_sustav-2dof}) ekvivalentni model;
        (\subref{fig:sile_nepriguseni_ekvivalentni_sustav-2dof}) prikaz sila}
    \label{fig:nepriguseni_sustav-2dof}
\end{figure}

Sustavi sa slike imaju dva dinamička stupnja slobode jer su moguće dvije translacije
masa, pa jednadžbu gibanja opisuje sustav od dvije diferencijelne
jednadžbe drugog reda.
\begin{equation}\label{eq:sustav_diferencijalnih}
    \begin{dcases}
        m_1\ddot{u}_1 + (k_1+k_2)u_1 -k_2u_2 = 0\\
        m_1\ddot{u}_2 - k_2u_1 + k_2 u_2 = 0
    \end{dcases}
\end{equation}

Zapisano u matričnoj formi:
\begin{equation}\label{eq:sustav_diferencijalnih_matricno}
    \begin{bmatrix}
        m_1 & 0 \\
        0   & m_2
    \end{bmatrix}
    \begin{Bmatrix}
        \ddot{u}_1\\
        \ddot{u}_2
    \end{Bmatrix}
    +
    \begin{bmatrix}
        k_1+k_2 & -k_2\\
        -k_2 & k_2
    \end{bmatrix}
    \begin{Bmatrix}
        u_1\\
        u_2
    \end{Bmatrix}
    =
    \begin{Bmatrix}
        0\\
        0
    \end{Bmatrix}
\end{equation}

Odnosno
\begin{equation}\label{eq:sustav_diferencijalnih_matricni_kratko}
    \mm\vtor{u}{:}+\kk\vtor{u}{}=\vtor{0}{}
\end{equation}
Iz \eqref{eq:sustav_diferencijalnih} i \eqref{eq:sustav_diferencijalnih_matricno}
vidi se da je sustav diferencijalnih jednadžbi povezan preko krutosti odnosno
matrice krutosti. Opći oblik rješenja sustava je slijedeći:
\begin{equation}\label{eq:rjesenje_opcenitog_sustava}
    \vtor{u(t)}{} = \vtor{\psi}{}q(t)
\end{equation}

Vektor $\psi$ nije ovisan o vremenu pa ga u nekom smislu možemo smatrati konstantom
integracije (~\cite{diferencijalne}), a funkcija $q(t)$ je jednostavna harmonijska 
funkcija\footnotemark slijedećeg oblika: \begin{equation}\label{eq:jednostavna_harmonijska_funkcija}
    q(t)=A\cos(\omega t) + B\sin(\omega t)
\end{equation}

\footnotetext{Uočimo da je harmonijska funkcija $q(t)$ rješenje za jedan stupanj slobode}

Druga derivacija \eqref{eq:jednostavna_harmonijska_funkcija} jest:
\begin{equation}\label{eq:jednostavna_harmonijska_funkcija_dd}
    \ddot{q}(t)=-\omega^2(
    \underbrace{
        A\cos(\omega t) + B\sin(\omega t)
    }_{\text{$q(t)$}}
    )
    =-\omega^2q(t)
\end{equation}

Stoga, druga derivacija od \eqref{eq:rjesenje_opcenitog_sustava} glasi:
\begin{equation}\label{eq:rjesenje_opcenitog_sustava_dd}
    \vtor{u}{:}=-\omega^2q(t)\vtor{\psi}{}
\end{equation}

Uvrštavanjem \eqref{eq:rjesenje_opcenitog_sustava} i \eqref{eq:rjesenje_opcenitog_sustava_dd}
u \eqref{eq:sustav_diferencijalnih_matricni_kratko} dobijemo:
\begin{equation}
    (\vtor{\psi}{}\kk-\omega^2\vtor{\psi}{}\mm)q(t)=\vtor{0}{}
\end{equation}
Prvo trivijalno rješenje je za $q(t)=0$ što implicira da je $u(t)=0$ (sustav
miruje). Netrivijalno rješenje se dobije izjednačavanjem zagrade s nulom:

\begin{equation}\label{eq:vlastite_vrijednosti}
    \kk\{\psi\}=\omega^2\mm\{\psi\}
\end{equation}
Izraz \eqref{eq:vlastite_vrijednosti} predstavlja realni problem vlastitih
vrijednosti odnosno matrični problem vlastitih vrijednosti. Potrebno je odrediti
dvije nepoznanice: 
\begin{enumerate}
    \item vlastite vektore $\psi$
    \item vlastite vrijednosti $\omega^2$
\end{enumerate}

Prebacivanjem nepoznanica na jednu stranu dobijemo homogeni sustav:
\begin{equation}\label{eq:vlastite_vrijednosti_homogeno}
    (\kk-\omega^2\mm)\vtor{\psi}{}=\vtor{0}{}
\end{equation}

koji u općem slučaju predstavlja sustav od N algebarskih jednadžbi s N nepoznanica. 
Trivijalno rješenje sustava je za $\{\psi\}={0}$, a netrivijalno se određuje raspisom 
determinante matrice $\kk-\omega^2\mm$. Raspisom determinante navedene matrice, 
dobije se polinom N-tog stupnja kojeg nazivamo \textit{karakterističnim polinomom}. 
Nultočke polinoma predstavljaju vlastite vrijednosti $\omega^2$, odnosno kvadrirane 
prirodne frekvencije. Da bi nultočke polinoma bile realne pozitivne vrijednosti, 
matrice $\mm$ i $\kk$ moraju biti simetrične i pozitivno definitne (~\cite{dk_skripta}).
Uvijeti za pozitivnu definitnost u građevinarstvu su slijedeći:
\begin{enumerate}
    \item za matricu $\kk$ - broj i raspored ležajeva u ispravnoj mreži mora biti
        takav da se spriječe pomaci krutog tijela (~\cite{dk_skripta}).
    \item za matricu $\mm$ - moraju se ukloniti stupnjevi slobode bez pridružene
        koncentrirane mase. Uklanjanje stupnjeva slobode bez mase, vrši se
        statičkom kondenzacijom (~\cite{dk_skripta}). 
\end{enumerate}

Vlastiti vektori $\psi$ se određuju uvrštavanjem vrijednosti $\omega^2$ u matricu
$\kk-\omega^2\mm$, stoga je očito da vektori $\psi$ nisu jednoznačni jer i njihovi
višektratnici zadovoljavaju jednadžbu \eqref{eq:vlastite_vrijednosti_homogeno}.
Vektori $\psi$ nazivaju se \textit{oblicima titranja (osciliranja) sustava}, 
a definiraju oblik titranja
sustava na frekvenciji $\omega$. Prvi vlastiti vektor $\psi_1$, naziva se temeljnim
(osnovnim) oblikom osciliranja, a frekvencija $\omega_1$ na kojoj sustav titra navedenim
oblikom naziva se \textit{vlastitom frekvencijom temeljnog oblika}.
\par

Ako su sve prirodne frekvencije različite od nule i međusobno različite, tada su svi
vlastiti vektori linearno nezavisni. Skup od n linearno nezavisnih vektora čini bazu
n-dimenzionalnog vektorskog prostora, pa je ukupno rješenje sustava diferencijalnih
jednadžbi linearna kombinacija svih pojedinačnih rješenja.
\begin{equation}\label{eq:opce_rjesenje_sustava}
    \vtor{u(t)}{}=\sum_{n=1}^N\vtor{\psi}{}_nq_n 
\end{equation}
Pri čemu je $q_n$:
\begin{equation}
    q_n=A_n\cos(\omega_n t) + B_n\sin(\omega_n t)
\end{equation}

Raspisivanjem \eqref{eq:opce_rjesenje_sustava} dobivamo:
\[
	\begin{Bmatrix}
		u_1\\
		u_2\\
		\vdots\\
		u_n
	\end{Bmatrix}
	=
	q_1(t)
	\begin{Bmatrix}
		\psi_{1,1}\\
		\psi_{2,1}\\
		\vdots\\
		\psi_{N,1}
	\end{Bmatrix}
	+
	q_2(t)
	\begin{Bmatrix}
		\psi_{1,2}\\
		\psi_{2,2}\\
		\vdots\\
		\psi_{N,2}
	\end{Bmatrix}
		+
		\cdots
		+
	q_N(t)
	\begin{Bmatrix}
		\psi_{1,N}\\
		\psi_{2,N}\\
		\vdots\\
		\psi_{N,N}
	\end{Bmatrix}
	\]
\[
	=
	\begin{bmatrix}
		q_1(t) \psi_{1,1} + q_2(t) \psi_{1,2} + q_N(t) \psi_{1,N} \\
		q_1(t) \psi_{2,1} + q_2(t) \psi_{2,2} + q_N(t) \psi_{2,N} \\
		\vdots \\
		q_1(t) \psi_{N,1} + q_2(t) \psi_{N,2} + q_N(t) \psi_{N,N}
	\end{bmatrix}
	=
	\underbrace{
	\begin{bmatrix}
		\psi_{1,1} & \psi_{1,2} & \cdots & \psi_{1_N} \\
		\psi_{2,1} & \psi_{2,2} & \cdots & \psi_{2_N} \\
		\vdots & \vdots & \ddots & \vdots \\
		\psi_{N,1} & \psi_{N,2} & \cdots & \psi_{N,N} 
	\end{bmatrix}
	}_{\text{\large{$\ppsi$}}}
	\underbrace{
	\begin{Bmatrix}
		q_1(t) \\
		q_2(t) \\
		\vdots \\
		q_n(t)
	\end{Bmatrix}
        }_{\text{\large{$\vtor{q}{}$}}}
\]

Matricu $\ppsi$ nazivamo modalna matrica, a komponente vektora $q$ nazivaju se
modalne koordinate. Opće rješenje pod \eqref{eq:opce_rjesenje_sustava} sada možemo 
zapisati matrično kao:
\begin{equation}
    \vtor{u(t)}{} = \ppsi \vtor{q}{}
\end{equation}


Osim modalne matrice postoji i spektralna matrica ($N$x$N$) koja se sastoji od N
svojstvenih vrijednosti $\omega^2$ na glavnoj dijagonali.
\[
	\oomega^2 
	= 
	\begin{bmatrix}
		\omega_1^2 & 0 & 0 & \cdots & 0 \\
		0 & \omega_2^2 & 0 & \cdots & 0 \\
		0 & 0 & \omega_3^2 & \cdots & 0 \\
		\vdots  & \vdots  & \vdots  & \ddots &  0 \\
		0 & 0 & 0 & \cdots &  \omega_N^2 
	\end{bmatrix}
\]


Za slučaj sustava s dva stupnja slobode, definiranog sustavom diferencijalnih
jednadžbi pod \eqref{eq:sustav_diferencijalnih_matricno}, prirodne frekvencije 
$\omega_1^2$ i $\omega_2^2$ dobivene su rješavanjem kvadratne jednadžbe karakterističnog
polinoma za $\omega^2$. Vlastite vektore možemo zapisati kao:
\begin{align}
    \vtor{\psi}{}_1=
    \begin{Bmatrix}
        \psi_1\\
        \psi_2
    \end{Bmatrix}
    &=
    \begin{Bmatrix}
        \ffrac{k_1+k_2-\omega_1^2m_1}{k_2}\\
        1
    \end{Bmatrix}\\
    \vtor{\psi}{}_2=
    \begin{Bmatrix}
        \psi_1\\
        \psi_2
    \end{Bmatrix}
    &=
    \begin{Bmatrix}
        \ffrac{k_1+k_2-\omega_1^2m_1}{k_2}\\
        1
    \end{Bmatrix}
\end{align}

Ukupno rješenje sustava jest linearna kombinacija slijedećih vektora:
\begin{equation}
    \begin{dcases}
        \vtor{u_1}{}(t) = \vtor{\psi}{}_1 q_1(t) = \vtor{\psi}{}_1 (A_1\cos(\omega_1 t) + B_1\sin(\omega_1 t))\\
        \vtor{u_2}{}(t) = \vtor{\psi}{}_2 q_2(t) = \vtor{\psi}{}_2 (A_2\cos(\omega_2 t) + B_2\sin(\omega_2 t))
    \end{dcases}
\end{equation}

Stoga, ukupno opće rješenje glasi:
\begin{equation}\label{eq:ukupno_opce_rjesenje_2dof}
    \vtor{u}{}(t)=\vtor{u_1}{}(t)+\vtor{u_2}{}(t) 
\end{equation}

Općenitiji zapis jednadžbe pod \eqref{eq:ukupno_opce_rjesenje_2dof} glasi:
\begin{equation}\label{eq:ukupno_opce_rjesenje_mdof}
    \vtor{u}{}(t)=\sum_{n=1}^N \vtor{\psi}{}_n (A_n\cos(\omega_nt) + B_n\sin(\omega_nt)
\end{equation}

\newpage
Bitno je za napomenuti da vlastiti vektor $\psi$ ne određuje maksimalne iznose
ordinata već samo njihov relativni odnos, tj. oblik titranja. Da
bismo dobili amplitude $A_n$ i $B_n$, potrebno je uzeti u obzir početne uvjete:
\begin{equation}
    \vtor{u}{}(0)  = \begin{Bmatrix} u_1(0)\\ u_2(0)\\ \vdots\\ u_N(0) \end{Bmatrix}
    \qquad \text{i} \qquad
    \vtor{u}{.}(0) = \begin{Bmatrix} \dot{u}_1(0)\\ \dot{u}_2(0)\\ \vdots\\ \dot{u}_N(0) \end{Bmatrix}
\end{equation}

Za slučaj slobodnog titranja, konstante $A_n$ i $B_n$ glase:
\begin{align}
    A_n&=q_n(0)\\
    B_n&=\frac{\dot{q}_n(0)}{\omega_n}
\end{align}

pri čemu je:
\begin{align*}
    q_n(0) &= \frac{\vtor{\psi}{}_n^T \mm \vtor{u}{}(0)}{\vtor{\psi}{}_n^T \mm \vtor{\psi}{}_n}\\
    \dot{q}_n(0) &= \frac{\vtor{\psi}{}_n^T \mm \vtor{u}{.}(0)}{\vtor{\psi}{}_n^T \mm \vtor{\psi}{}_n}
\end{align*}
Shematski prikaz oblika titranja sustava s dva stupnja slobode prikazan je na slijedećoj
slici.
\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \centering
        \input{skice/mdf/psi-2}
        \caption{Prvi vlastiti oblik titranja}
    \end{subfigure}
    \begin{subfigure}[b]{0.4\textwidth}
        \centering
        \input{skice/mdf/psi-1}
        \caption{Drugi vlastiti oblik titranja}
    \end{subfigure}
    \caption{Shematski prikaz vlastitih oblika titranja sustava s dva stupnja slobode}
\end{figure}
